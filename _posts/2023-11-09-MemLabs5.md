---
layout: post
title: "MemLabs: Lab5 Writeup"
date: 2023-11-09
tags: [Memory Forensics] 
description: The post shows the steps for finding the flags for the 5th challenge of MemLabs.
---

# Introduction

Last time, I posted a solution that shows how I approached the [fourth lab](https://oviche.github.io/2023/10/MemLabs4/) of [MemLabs](https://github.com/stuxnet999/MemLabs/tree/master) challenges. This post continues to show how I got the flags for the fourth lab of MemLabs, called **"Black Tuesday"**.

# Extracting the clues from description

The following is the challenge description that contains the needed clues to solve this lab.

> **We received this memory dump from our client recently. Someone accessed his system when he was not there and he found some rather strange files being accessed. Find those files and they might be useful. I quote his exact statement :**
> **"The names were not readable. They were composed of alphabets and numbers but I wasn't able to make out what exactly it was."**

> **Also, he noticed his most loved application that he always used crashed every time he ran it. Was it a virus?**

> **Note-1: This challenge is composed of 3 flags. If you think 2nd flag is the end, it isn't!! :P**

> **Note-2: There was a small mistake when making this challenge. If you find any string which has the string "L4B_3_D0n3!!" in it, please change it to "L4B_5_D0n3!!" and then proceed.**

> **Note-3: You'll get the stage 2 flag only when you have the stage 1 flag.**

I managed to extract the following two clues:

- **The file names were not readable. They were composed of alphabets and numbers**, is a hint to look for files with names containing alphabets and numbers.
- **He noticed his most loved application that he always used crashed every time he ran it. Was it a virus?**, is a hint to inspect the crashing application.

# Finding the image profile

First of all, we need to find the profile of the memory image using imageinfo plugin as in the following command.

> CommandLine 
{:.filename}
{% highlight CMD %}
$ ./vol -f MemoryDump_Lab5.raw imageinfo
Volatility Foundation Volatility Framework 2.6
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418
                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)
                     AS Layer2 : FileAddressSpace (/home/oviche/Desktop/memlabs/MemoryDump_Lab5.raw)
                      PAE type : No PAE
                           DTB : 0x187000L
                          KDBG : 0xf800028460a0L
          Number of Processors : 1
     Image Type (Service Pack) : 1
                KPCR for CPU 0 : 0xfffff80002847d00L
             KUSER_SHARED_DATA : 0xfffff78000000000L
           Image date and time : 2019-12-20 03:47:57 UTC+0000
     Image local date and time : 2019-12-20 09:17:57 +0530
{% endhighlight %}

The first suggested profile **"Win7SP1x64"** worked in my case.

# Locating the files with the names of alphabets and numbers

