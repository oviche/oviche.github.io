---
layout: post
title: "Cyber espionage on Tibetian citizens"
date: 2023-01-25
tags: x86 malware 
description: The post shows the details of a malware attack that was developed by a Chinese state-sponsored group to spy on Tibetian citizens. 
---

# Intro

- This post will mainly include the details of my analysis of the stages of the attack, malware classification, tool tracking, and indicators of compromise.  

# Description of kill chain

- The following diagram shows the flow of attack from the initial access to communication with the C2 server.
  
  ![img]({{ '/assets/images/espionage_tibet_image/lowzero_1.png' | relative_url }}){: .center-image }*(**Kill-chain diagram**)*
  
   ## Delivery
   
   - The malware is delivered as an RTF document, maybe through phishing mail, that contains an application form written in the chinese-tibetian language as it appears below.
  
  ![img]({{ '/assets/images/espionage_tibet_image/lowzero_2.png' | relative_url }}){: .center-image }*(**RTF document page [1]**)*
 
  ![img]({{ '/assets/images/espionage_tibet_image/lowzero_3.png' | relative_url }}){: .center-image }*(**RTF document page [2]**)*

 - This may indicate that this attack is targeting Tibetan people.

   ## Exploitation
  
   - This RTF document contains 2 embedded objects one of them with the name of **Equation.2\x00\x124Vx\x90\x124VxvT2**. After searching this name, I find that this RTF is generated by a tool called **Royal Road** which usually includes one of the exploits which target the equation editor vulnerabilities of the office.
  
   - This RTF document contains an exploit that takes advantage of  RCE vulnerabilities in the equation editor of Microsoft Office; which allows one to write mathematical equations and formulas.
  
  
  
   ## Installation & Reconnaissance
  
   - Once the exploit is triggered, an executable (the second embedded object in the RTF document) is decrypted and executed which executes and injects a shellcode inside **RUNDLL32.exe**.
 
   - Then the shellcode unpack, load, and execute a dll file which acts as a backdoor.

   - This backdoor collects various host information from the infected host which may be used to check if the machine is an interesting target or not.
  
  
   ## Command and Control
 
   - The backdoor communicates with the C2 server on port 110 and sends the collected information and waits till receiving one or more commands to get executed.

