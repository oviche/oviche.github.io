---
layout: post
title: "MemLabs: Lab4 Writeup"
date: 2023-10-09
tags: [Memory Forensics] 
description: The post shows the steps for finding the flags for the 4th challenge of MemLabs.
---

# Introduction

Last time, I posted a solution that shows how I approached the [third lab]([https://oviche.github.io/2023/10/MemLabs3/](https://oviche.github.io/2023/10/MemLabs3/)](https://oviche.github.io/2023/10/MemLabs3/)) of [MemLabs](https://github.com/stuxnet999/MemLabs/tree/master) challenges. This post continues to show how I got the flags for the fourth lab of MemLabs, called **"The Evil's Den"**.

# Extracting the clues from description

The following is the challenge description that contains the needed clues to solve this lab.
> **My system was recently compromised. The Hacker stole a lot of information but he also deleted a very important file of mine. I have no idea on how to recover it. The only evidence we have, at this point of time is this memory dump. Please help me.**

The only clue that exist is that we need to search for the deleted important file.

# Finding the image profile

First of all, we need to find the profile of the memory image using `imageinfo` plugin as in the following command.

> CommandLine 
{:.filename}
{% highlight CMD %}
$ ./vol -f MemoryDump_Lab4.raw imageinfo
Volatility Foundation Volatility Framework 2.6
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418
                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)
                     AS Layer2 : FileAddressSpace (/home/oviche/Desktop/memlabs/MemoryDump_Lab4.raw)
                      PAE type : No PAE
                           DTB : 0x187000L
                          KDBG : 0xf800027f60a0L
          Number of Processors : 1
     Image Type (Service Pack) : 1
                KPCR for CPU 0 : 0xfffff800027f7d00L
             KUSER_SHARED_DATA : 0xfffff78000000000L
           Image date and time : 2019-06-29 07:30:00 UTC+0000
     Image local date and time : 2019-06-29 13:00:00 +0530
{% endhighlight %}

The first suggested profile **"Win7SP1x64"** worked in my case.
