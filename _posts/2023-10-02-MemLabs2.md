---
layout: post
title: "MemLabs: Lab2 Writeup"
date: 2023-10-02
tags: [Memory Forensics] 
description: The post shows the steps for finding the flags for the second challenge of MemLabs.
---

# Introduction

Last time, I posted a solution that shows how I approached the [first lab](https://oviche.github.io/2023/09/MemLabs1/) of [MemLabs](https://github.com/stuxnet999/MemLabs/tree/master) challenges. This post continues to show how I got the flags for the second lab of MemLabs, called **"A New World"**.


# Extracting the clues from description

The following is the challenge description that contains the needed clues to solve this lab.

> **One of the clients of our company, lost the access to his system due to an unknown error. He is supposedly a very popular "environmental" activist. As a part of the investigation, he told us that his go to applications are browsers, his password managers etc. We hope that you can dig into this memory dump and find his important stuff and give it back to us.**

I managed to extract the following two clues:

1. **"He is supposedly a very popular "environmental" activist"**, using the word "environmental" is a hint to check environment variables. 
2. **"He told us that his go-to applications are browsers, his password managers, etc."**, this sentence is a hint to get his important data from the browser and password manager.

# Checking the environment variables

I used `envars` plugin to check the environment variables as in the following command.
> CommandLine 
{:.filename}
{% highlight CMD %}
$ ./vol -f MemoryDump_Lab2.raw --profile=Win7SP1x64 envars
{% endhighlight %}

By scrolling around the results of the executed command, I noticed an environment variable "NEW_TMP" get repeated and its value looks like holding a base64 encoded string.

![img]({{'/assets/images/MemLab2/img1.png' | relative_url }}){: .center-image }*(**The results of envars plugin**)*

When I tried to decode that possible base64 encoded string, the flag for the first stage was printed, as appears in the below command.
> CommandLine 
{:.filename}
{% highlight CMD %}
$ echo "ZmxhZ3t3M2xjMG0zX1QwXyRUNGczXyFfT2ZfTDRCXzJ9" | base64 -d
flag{w3lc0m3_T0_$T4g3_!_Of_L4B_2}
{% endhighlight %}

# Locating important data from the password manager

